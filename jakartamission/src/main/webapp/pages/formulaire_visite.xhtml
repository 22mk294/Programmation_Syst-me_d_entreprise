<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="jakarta.faces.html" xmlns:f="jakarta.faces.core">
<h:head>
    <title>Formulaire de Visite</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" />
</h:head>

<f:metadata>
    <f:viewParam name="lieuId" value="#{visiteBean.lieuId}" />
</f:metadata>

<h:body class="bg-light">

    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-danger">
        <div class="container">
            <a class="navbar-brand fw-bold" href="#">UDBL - Formulaire de Visite</a>
        </div>
    </nav>

    <!-- PAGE -->
    <div class="container mt-5">
        <div class="card shadow p-4">
            <h2 class="mb-4">Enregistrer une visite</h2>

            <h:messages globalOnly="true" infoClass="alert alert-success" errorClass="alert alert-danger"
                style="list-style: none; padding: 0;" />

            <h:form>
                <div class="mb-3">
                    <label for="lieuId" class="form-label">Lieu à visiter</label>
                    <h:selectOneMenu id="lieuId" value="#{visiteBean.lieuId}" styleClass="form-select" required="true"
                        requiredMessage="Veuillez sélectionner un lieu.">
                        <f:selectItem itemLabel="Sélectionnez un lieu" itemValue="" noSelectionOption="true" />
                        <f:selectItems value="#{lieuBean.lieux}" var="lieu" itemValue="#{lieu.id}"
                            itemLabel="#{lieu.nom}" />
                    </h:selectOneMenu>
                    <h:message for="lieuId" style="color:red" />
                </div>

                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="tempsPasse" class="form-label">Temps passé (heures)</label>
                        <h:inputText id="tempsPasse" value="#{visiteBean.tempsPasse}" styleClass="form-control"
                            type="number">
                            <f:passThroughAttribute name="step" value="0.5" />
                        </h:inputText>
                    </div>

                    <div class="col-md-6 mb-3">
                        <label for="depense" class="form-label">Dépense ($)</label>
                        <h:inputText id="depense" value="#{visiteBean.depense}" styleClass="form-control" type="number">
                            <f:passThroughAttribute name="step" value="0.01" />
                        </h:inputText>
                    </div>
                </div>

                <div class="mb-3">
                    <label for="observation" class="form-label">Observation / Commentaire</label>
                    <h:inputTextarea id="observation" value="#{visiteBean.observation}" styleClass="form-control"
                        rows="3" />
                </div>

                <div class="d-flex gap-2">
                    <h:commandButton value="Enregistrer la visite" action="#{visiteBean.enregistrerVisite}"
                        styleClass="btn btn-danger" />
                    <h:commandButton value="Annuler" action="visite" immediate="true"
                        styleClass="btn btn-outline-secondary" />
                </div>
            </h:form>
        </div>
    </div>

</h:body>

</html>